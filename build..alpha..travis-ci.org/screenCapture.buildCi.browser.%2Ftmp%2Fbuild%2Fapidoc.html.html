<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/hayes/unpm">unpm (v1.5.0)</a>
</h1>
<h4>private npm registry in node</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.unpm">module unpm</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package">
            function <span class="apidocSignatureSpan">unpm.</span>Package
            <span class="apidocSignatureSpan">(unpm)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">unpm.</span>Package.prototype</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">unpm.</span>unpublish</span>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.unpm.Package">module unpm.Package</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.Package">
            function <span class="apidocSignatureSpan">unpm.</span>Package
            <span class="apidocSignatureSpan">(unpm)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.unpm.Package.prototype">module unpm.Package.prototype</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype._setMeta">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>_setMeta
            <span class="apidocSignatureSpan">(name, meta, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.getVersionMeta">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>getVersionMeta
            <span class="apidocSignatureSpan">(name, version, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.getVersions">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>getVersions
            <span class="apidocSignatureSpan">(name, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.publish">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>publish
            <span class="apidocSignatureSpan">(meta, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.remove">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>remove
            <span class="apidocSignatureSpan">(name, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.removeVersion">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>removeVersion
            <span class="apidocSignatureSpan">(name, version, done)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.Package.prototype.saveMeta">
            function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>saveMeta
            <span class="apidocSignatureSpan">(name, version, tags, meta, done)</span>
            </a>

        </li>

    </ol></li>

    <li class="apidocModuleLi"><a href="#apidoc.module.unpm.unpublish">module unpm.unpublish</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.unpublish.all">
            function <span class="apidocSignatureSpan">unpm.unpublish.</span>all
            <span class="apidocSignatureSpan">(respond, route, unpm)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.unpublish.some">
            function <span class="apidocSignatureSpan">unpm.unpublish.</span>some
            <span class="apidocSignatureSpan">(respond, route, unpm)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.unpm.unpublish.tarball">
            function <span class="apidocSignatureSpan">unpm.unpublish.</span>tarball
            <span class="apidocSignatureSpan">(respond, route, unpm)</span>
            </a>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.unpm" id="apidoc.module.unpm">module unpm</a></h1>


    <h2>
        <a href="#apidoc.element.unpm.Package" id="apidoc.element.unpm.Package">
        function <span class="apidocSignatureSpan">unpm.</span>Package
        <span class="apidocSignatureSpan">(unpm)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Package(unpm) {
  if(!(this instanceof Package)) {
    return new Package(unpm)
  }

  var self = this
  methods.forEach(function(method) {
    self[method] = unpm.backend[method] &amp;&amp; unpm.backend[method].bind(unpm.backend)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>






</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.unpm.Package" id="apidoc.module.unpm.Package">module unpm.Package</a></h1>


    <h2>
        <a href="#apidoc.element.unpm.Package.Package" id="apidoc.element.unpm.Package.Package">
        function <span class="apidocSignatureSpan">unpm.</span>Package
        <span class="apidocSignatureSpan">(unpm)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function Package(unpm) {
  if(!(this instanceof Package)) {
    return new Package(unpm)
  }

  var self = this
  methods.forEach(function(method) {
    self[method] = unpm.backend[method] &amp;&amp; unpm.backend[method].bind(unpm.backend)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.unpm.Package.prototype" id="apidoc.module.unpm.Package.prototype">module unpm.Package.prototype</a></h1>


    <h2>
        <a href="#apidoc.element.unpm.Package.prototype._setMeta" id="apidoc.element.unpm.Package.prototype._setMeta">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>_setMeta
        <span class="apidocSignatureSpan">(name, meta, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function _setMeta(name, meta, done) {
  meta._rev = ~~meta._rev + 1
  this.setMeta(name, meta, done)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  }

  delete meta.versions[version]

  meta['dist-tags'].latest = latest_version(Object.keys(meta.versions))

  if(Object.keys(meta.versions).length) {
    self.<span class="apidocCodeKeywordSpan">_setMeta</span>(name, meta, removeTarball)
  } else {
    self.removeMeta(name, meta, removeTarball)
  }
})

function removeTarball(err, data) {
  if(err) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.getVersionMeta" id="apidoc.element.unpm.Package.prototype.getVersionMeta">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>getVersionMeta
        <span class="apidocSignatureSpan">(name, version, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getVersionMeta(name, version, done) {
  this.getMeta(name, guard(function(meta) {
    if(!meta) {
      return done()
    }

    version = versionFromMeta(meta, version)

    if(!version) {
      done()
    }

    var versionMeta = meta.versions[version]

    if(!versionMeta._id) {
      versionMeta._id = name + '@' + version
    }

    done(null, versionMeta)
  }, done))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  var version = route.params.version
  var name = route.params.name

  if(!version) {
return unpm.Package.getMeta(name, returnMeta)
  }

  unpm.Package.<span class="apidocCodeKeywordSpan">getVersionMeta</span>(name, version, returnMeta)

  function returnMeta(err, meta) {
if(err) {
  return respond(err)
}

if(!meta) {
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.getVersions" id="apidoc.element.unpm.Package.prototype.getVersions">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>getVersions
        <span class="apidocSignatureSpan">(name, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function getVersions(name, done) {
  this.getMeta(name, guard(function(meta) {
    if(!meta) {
      return done()
    }

    done(null, Object.keys(meta.versions))
  }, done))
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
var version

load(respond.req, guard(getVersions, respond))

function getVersions(meta) {
  var latest = meta['dist-tags'].latest

  unpm.Package.<span class="apidocCodeKeywordSpan">getVersions</span>(meta.name, function(err, versions) {
    if(versions &amp;&amp; versions.indexOf(latest) !== -1) {
      return respond.conflict()
    }

    unpm.Package.publish(meta, created)
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.publish" id="apidoc.element.unpm.Package.prototype.publish">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>publish
        <span class="apidocSignatureSpan">(meta, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function publish(meta, done) {
  var tags = meta['dist-tags']
  var name = meta.name
  var fixedVersion
  var filename
  var version
  var stream

  try {
    version = tags.latest
    filename = name + '-' + version + '.tgz'
    fixedVersion = version.replace(
        /^[\d\.]*/
      , version.match(/^[\d\.]*/)[0].split('.').map(function(val) {
          return +val
        }).join('.')
    )
    meta.versions[fixedVersion] = meta.versions[version]
    stream = this.setTarball(name, fixedVersion)
    stream.write(new Buffer(meta._attachments[filename].data, 'base64'))
    stream.end()
  } catch(err) {
    done(err)
  }

  delete meta._attachments
  this.saveMeta(name, fixedVersion, tags, meta, done)
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    var latest = meta['dist-tags'].latest

    unpm.Package.getVersions(meta.name, function(err, versions) {
      if(versions &amp;&amp; versions.indexOf(latest) !== -1) {
        return respond.conflict()
      }

      unpm.Package.<span class="apidocCodeKeywordSpan">publish</span>(meta, created)
    })
  }

  function created(err, data) {
    respond(err, 201, data)
  }
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.remove" id="apidoc.element.unpm.Package.prototype.remove">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>remove
        <span class="apidocSignatureSpan">(name, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function remove(name, done) {
  var self = this

  self.getVersions(name, function(err, versions) {
    if(err || !versions.length) {
      return done(err)
    }

    var remaining = versions.length
      , returned

    versions.forEach(function(version) {
      self.removeTarball(name, version, removed)
    })

    function removed(err) {
      if(returned) {
        return
      }

      if(err) {
        returned = true

        return done(err)
      }

      if(!--remaining) {
        returned = true
        self.removeMeta(name, done)
      }
    }
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
module.exports.all = removeAll
module.exports.some = removeSome
module.exports.tarball = removeTarball

function removeAll(respond, route, unpm) {
  var name = route.params.name

  unpm.Package.<span class="apidocCodeKeywordSpan">remove</span>(name, function(err, data) {
    if(err) {
      return respond(err)
    }

    respond(null, 200, data)
  })
}
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.removeVersion" id="apidoc.element.unpm.Package.prototype.removeVersion">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>removeVersion
        <span class="apidocSignatureSpan">(name, version, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeVersion(name, version, done) {
  var self = this

  self.getMeta(name, function(err, meta) {
    if(err) {
      return done(err)
    }

    version = versionFromMeta(meta, version)

    var versionMeta = meta.versions[version]

    if(!version || !versionMeta) {
      return done()
    }

    delete meta.versions[version]

    meta['dist-tags'].latest = latest_version(Object.keys(meta.versions))

    if(Object.keys(meta.versions).length) {
      self._setMeta(name, meta, removeTarball)
    } else {
      self.removeMeta(name, meta, removeTarball)
    }
  })

  function removeTarball(err, data) {
    if(err) {
      return done(err)
    }

    self.removeTarball(name, version, function(err) {
      done(err, data)
    })
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  return respond.notFound()
}

var remaining = versions.length
var returned = false

versions.forEach(function(version) {
  unpm.Package.<span class="apidocCodeKeywordSpan">removeVersion</span>(name, version, done)
})

function done(err, data) {
  if(returned) {
    return
  }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.Package.prototype.saveMeta" id="apidoc.element.unpm.Package.prototype.saveMeta">
        function <span class="apidocSignatureSpan">unpm.Package.prototype.</span>saveMeta
        <span class="apidocSignatureSpan">(name, version, tags, meta, done)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function saveMeta(name, version, tags, meta, done) {
  var self = this

  this.getMeta(name, function(err, module_meta) {
    module_meta = module_meta || {'dist-tags': {}, versions: {}, name: name}

    var versions = Object.keys(module_meta.versions)

    module_meta.versions[version] = meta.versions[version]
    versions.push(version)

    module_meta['dist-tags'].latest = latest_version(versions)

    Object.keys(tags).forEach(function(tag) {
      if(!module_meta['dist-tags'][tag]) {
        module_meta['dist-tags'][tag] = tags[tag]
      }
    })

    if(versions[0] === version) {
      for(var i = 0, l = metaKeys.length; i &lt; l; ++i) {
        module_meta[metaKeys[i]] = meta[metaKeys[i]]
      }
    }

    delete meta.readme

    self._setMeta(name, module_meta, function(err) {
      done(err, err ? null : module_meta)
    })
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
  stream.write(new Buffer(meta._attachments[filename].data, 'base64'))
  stream.end()
} catch(err) {
  done(err)
}

delete meta._attachments
this.<span class="apidocCodeKeywordSpan">saveMeta</span>(name, fixedVersion, tags, meta, done)
}

function saveMeta(name, version, tags, meta, done) {
var self = this

this.getMeta(name, function(err, module_meta) {
  module_meta = module_meta || {'dist-tags': {}, versions: {}, name: name}
...</pre></li>
    </ul>


</div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.unpm.unpublish" id="apidoc.module.unpm.unpublish">module unpm.unpublish</a></h1>


    <h2>
        <a href="#apidoc.element.unpm.unpublish.all" id="apidoc.element.unpm.unpublish.all">
        function <span class="apidocSignatureSpan">unpm.unpublish.</span>all
        <span class="apidocSignatureSpan">(respond, route, unpm)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeAll(respond, route, unpm) {
  var name = route.params.name

  unpm.Package.remove(name, function(err, data) {
    if(err) {
      return respond(err)
    }

    respond(null, 200, data)
  })
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.unpublish.some" id="apidoc.element.unpm.unpublish.some">
        function <span class="apidocSignatureSpan">unpm.unpublish.</span>some
        <span class="apidocSignatureSpan">(respond, route, unpm)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeSome(respond, route, unpm) {
  var name = route.params.name

  load(respond.req, function(err, data) {
    if(err) {
      return respond(err)
    }

    unpm.Package.getVersions(name, compare)

    function compare(err, versions) {
      if(err) {
        return respond(err)
      }

      remove(versions.map(missing).filter(Boolean))
    }

    function missing(version) {
      return !data.versions[version] &amp;&amp; version
    }
  })

  function remove(versions) {
    if(!versions.length) {
      return respond.notFound()
    }

    var remaining = versions.length
    var returned = false

    versions.forEach(function(version) {
      unpm.Package.removeVersion(name, version, done)
    })

    function done(err, data) {
      if(returned) {
        return
      }

      if(err) {
        returned = true

        return respond(err)
      }

      if(!--remaining) {
        returned = true
        respond(null, 200, {ok: 'updated package'})
      }
    }
  }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.unpm.unpublish.tarball" id="apidoc.element.unpm.unpublish.tarball">
        function <span class="apidocSignatureSpan">unpm.unpublish.</span>tarball
        <span class="apidocSignatureSpan">(respond, route, unpm)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">function removeTarball(respond, route, unpm) {
  respond(null, 200, {ok: 'file removed'})
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>


</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>